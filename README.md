# WebTest
WebアプリのUIテスト自動化ツール

## Feature
- テキスト（CSV）によるテストシナリオ実行・管理
- Seleniumによるテスト実行（マルチブラウザ対応）
- Javaによる拡張可能　※準備中
- GUIによるテストシナリオ編集　※準備中

## Usage
### Install
1. クローン

```
git clone https://github.com/mzk-wt/WebTest.git
```
2. Gradleプロジェクトとしてインポート

### Execution
1. シナリオ作成  
下記、Referenceの項を参照。
2. webtest.WebTest.javaを実行  
【コマンドラインパラメータ】  
　[0]ブラウザ種別（"chrome", "edge", "firefox"）  
　[1]出力フォルダのパス（フルパス）  
　[2]テストシナリオのパス（フルパス）  

## Sample
テストコード参照

## Reference
### Scenario
#### Format
テストシナリオは以下のフォーマットでCSVファイルを用意する。
```
<アクションコード>,<パラメータ１>,<パラメータ2>,<パラメータ3>,<パラメータ4>,<パラメータ5>
```

#### Scenario variable
各アクション間のデータのやり取りはシナリオ変数を介して行う。  
シナリオ変数に格納した値は```{{<変数名>}}```で呼び出すことができる。
```
GETTEXT,TEXT,id1,ID   // <- id="id1"のElementのテキストの値をシナリオ変数TEXTに格納
LOG,{{TEXT}}          // <- シナリオ変数TEXTに格納された値をログ出力
```

以下のシナリオ変数を予め用意している。上書き可能。
|変数名|内容|初期値|
|:---|:---|:---|
|@ROOT_PATH|カレントディレクトリ|System.getProperty("user.dir")で取得したパス|
|@OUTPUT_PATH|出力フォルダ|コマンドラインパラメータで指定した出力フォルダのパス|
|@SC_SAVEPATH|スクリーンショットの保存先|コマンドラインパラメータで指定した出力フォルダのパス|
|@SC_SEQ|スクリーンショットのファイル名連番|1|
|<ループID>@IDX|繰り返し処理時のループインデックス|-|
|<ループID>@ELEM|繰り返し処理時の各ループ毎の要素|-|

#### Actions
ページ遷移／ブラウザ操作系アクション
|アクションコード|内容|パラメータ1|パラメータ2|パラメータ3|パラメータ4|パラメータ5|
|:---|:---|:---|:---|:---|:---|:---|
|OPEN|ページを表示する|URL|-|-|-|-|
|NAVIGATE|ページを遷移する|URL|-|-|-|-|
|BACK|１つ戻る|-|-|-|-|-|
|FORWARD|１つ進む|-|-|-|-|-|
|WAIT|ページがロードされるまで待機する|待機時間（秒）|-|-|-|-|
|GETWINHANDLE|ウィンドウハンドルを取得する|格納先のシナリオ変数|ウィンドウ番号（省略した場合、現在のウィンドウ。"-1"で最後のウィンドウ。）|-|-|-|
|WINSWITCH|ウィンドウを切り替える|ウィンドウ名 or ウィンドウハンドル|-|-|-|-|
|CLOSE|ウィンドウを閉じる|-|-|-|-|-|
|WINSIZE|ウィンドウサイズを変更する|0:ウィンドウサイズ設定<br>1:ウィンドウ最大化|横幅（サイズ設定の場合のみ）|縦幅（サイズ設定の場合のみ）|-|-|
|SCROLL|ページをスクロールする|0:指定した移動量だけスクロール<br>1:指定した要素までスクロール|横方向の移動量|縦方向の移動量|要素検索方法（省略時は"CSS"）|要素番号（省略時は"0"）|

取得系アクション
|アクションコード|内容|パラメータ1|パラメータ2|パラメータ3|パラメータ4|パラメータ5|
|:---|:---|:---|:---|:---|:---|:---|
|GETURL|現在のURLを取得する|格納先のシナリオ変数|-|-|-|-|
|GETTITLE|タイトルを取得する|格納先のシナリオ変数|-|-|-|-|
|GETTEXT|テキストを取得する|格納先のシナリオ変数|要素検索文字列|要素検索方法（省略時は"CSS"）|要素番号（省略時は"0"）|-|
|GETATTR|属性を取得する|格納先のシナリオ変数|取得対象の属性|要素検索文字列|要素検索方法（省略時は"CSS"）|-|
|SAVECAPTURE|スクリーンショットをファイルに保存する|ファイル名|保存先のパス（省略時はシナリオ変数@SC_SAVEPATHのパス）|-|-|-|

入力系アクション
|アクションコード|内容|パラメータ1|パラメータ2|パラメータ3|パラメータ4|パラメータ5|
|:---|:---|:---|:---|:---|:---|:---|
|SENDKEY|キーボードから入力する|入力値|要素検索文字列|要素検索方法（省略時は"CSS"）|-|-|
|SELECT|ドロップダウン項目を選択する|選択方法（0:index,1:value,2:visible text）|選択値|要素検索文字列|要素検索方法（省略時は"CSS"）|-|
|CLICK|クリックする|要素検索文字列|要素検索方法（省略時は"CSS"）|-|-|-|
|EXECSCRIPT|スクリプトを実行する|Javascript|Args0|Args1|Args2|Args3|

シナリオ制御系アクション
|アクションコード|内容|パラメータ1|パラメータ2|パラメータ3|パラメータ4|パラメータ5|
|:---|:---|:---|:---|:---|:---|:---|
|FOR|繰り返し処理開始（指定回数）|ループID|繰り返し回数|オプション（START=インデックス初期値(省略時0);STEP=インデックスのステップ数(省略時1)）|-|-|
|FORELEM|繰り返し処理開始（指定要素）|ループID|要素検索文字列|要素検索方法（省略時は"CSS"）|オプション（START=インデックス初期値(省略時0);STEP=インデックスのステップ数(省略時1)）|-|
|ENDFOR|繰り返し処理終了|-|-|-|-|-|

その他のアクション
|アクションコード|内容|パラメータ1|パラメータ2|パラメータ3|パラメータ4|パラメータ5|
|:---|:---|:---|:---|:---|:---|:---|
|NONE|なにもしない（コメント用）|-|-|-|-|-|
|SETVAL|シナリオ変数に値をセットする|格納先のシナリオ変数|セットする値|-|-|-|
|LOG|ログを出力する|出力する値|出力先（0:ファイル,1:標準出力,2:両方）（省略時は1）|-|-|-|

#### 要素検索方法
要素検索方法には以下の値が使用できる。
|検索方法|説明|
|:---|:---|
|ELEM|要素を直接指定する。FORELEMループ内でのみ使用可能。|
|CLASS|クラス名で要素を検索する|
|CSS|CSSセレクタで要素を検索する|
|ID|ID属性で要素を検索する|
|LINK|リンク文字列で要素を検索する|
|NAME|NAME属性で要素を検索する|
|PLINK|リンク文字列の部分一致で要素を検索する|
|TAG|タグ名で要素を検索する|
|XPATH|XPATHで要素を検索する|
